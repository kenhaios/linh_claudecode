#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ“ Validating Vietnamese commit message format..."

# Read commit message
commit_msg=$(cat $1)

# Vietnamese commit message validation
# Allow both English and Vietnamese commit messages
# Format: type(scope): description
# Examples: 
# - feat(auth): thÃªm Ä‘Äƒng nháº­p báº±ng sá»‘ Ä‘iá»‡n thoáº¡i
# - fix(chart): sá»­a lá»—i tÃ­nh toÃ¡n lÃ¡ sá»‘ tá»­ vi
# - docs(readme): cáº­p nháº­t hÆ°á»›ng dáº«n tiáº¿ng Viá»‡t

commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|ci|build)(\(.+\))?: .{10,100}$'

if ! echo "$commit_msg" | grep -qE "$commit_regex"; then
  echo "âŒ Invalid commit message format!"
  echo ""
  echo "Commit message should follow this format:"
  echo "type(scope): description"
  echo ""
  echo "Types: feat, fix, docs, style, refactor, test, chore, perf, ci, build"
  echo "Description should be 10-100 characters"
  echo ""
  echo "Examples (Vietnamese supported):"
  echo "âœ… feat(auth): thÃªm Ä‘Äƒng nháº­p báº±ng sá»‘ Ä‘iá»‡n thoáº¡i"
  echo "âœ… fix(chart): sá»­a lá»—i tÃ­nh toÃ¡n lÃ¡ sá»‘ tá»­ vi"
  echo "âœ… docs(readme): cáº­p nháº­t hÆ°á»›ng dáº«n tiáº¿ng Viá»‡t"
  echo "âœ… feat(payment): add Vietnamese payment providers"
  echo ""
  echo "Your message: $commit_msg"
  exit 1
fi

echo "âœ… Vietnamese commit message format is valid!"