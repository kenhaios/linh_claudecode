# Redis configuration for Ha Linh Vietnamese Astrology Application

# Network and security
bind 0.0.0.0
protected-mode yes
port 6379

# Authentication
requirepass halinh123

# Vietnamese timezone setting
# Redis doesn't have timezone setting, but we document it here
# Application should handle Vietnamese timezone (Asia/Ho_Chi_Minh)

# Memory and persistence
maxmemory 256mb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000

# Append-only file for persistence
appendonly yes
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Slow log for debugging
slowlog-log-slower-than 10000
slowlog-max-len 128

# Client settings
timeout 300
tcp-keepalive 300
tcp-backlog 511

# Logging
loglevel notice
syslog-enabled no

# Database settings
databases 16

# Vietnamese-specific key prefixes documentation:
# halinh:session:{sessionId} - User sessions
# halinh:chart:{chartId} - Cached astrology charts
# halinh:ai:{queryHash} - Cached AI responses
# halinh:lunar:{year}:{month} - Lunar calendar cache
# halinh:user:{userId} - User data cache
# halinh:tokens:{userId} - Token balance cache

# Key expiration recommendations:
# Sessions: 1800 seconds (30 minutes)
# Charts: 86400 seconds (24 hours)
# AI responses: 3600 seconds (1 hour)
# Lunar calendar: 31536000 seconds (1 year)
# User cache: 3600 seconds (1 hour)

# Disable potentially dangerous commands in production
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command DEBUG ""